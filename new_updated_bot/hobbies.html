<!DOCTYPE html>
<html>
<head>
  <title>JPG Viewer</title>
  <style>
    body {
      font-family: Arial;
      margin: 20px;
    }
    img {
        width: 100%;
        height: 220px;
        object-fit: cover;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
   }
    img:hover {
        transform: scale(1.05);
        transition: 0.3s ease;
    }

    #exposure-therapy {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 15px;
   }

   /* .img-box {
  height: 220px;
  border-radius: 12px;
  overflow: hidden;
  background: #eee;
  
}

.img-box img {
  width: 100%;
  height: 100%;
  object-fit: contain;   /* üî• MAIN FIX */
  /* transition: transform 0.3s ease;
} */ 

/* .img-box:hover img {
  transform: scale(1.05);
} */

   #lightbox {
    position: fixed;
    inset: 0;
    background: #000;
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
}

#lightbox-img {
  max-width: 90vw;
  max-height: 90vh;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 12px;
  background: black;
  box-shadow: 0 0 40px rgba(255,255,255,0.2);
  
}


.nav {
  position: absolute;
  top: 50%;
  font-size: 50px;
  color: white;
  cursor: pointer;
  user-select: none;
}

.prev { left: 30px; }
.next { right: 30px; }

.close {
  position: absolute;
  top: 20px;
  right: 30px;
  font-size: 40px;
  color: white;
  cursor: pointer;
}

body.lightbox-open #exposure-therapy {
  display: none;   
}

/* #lightbox::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
    radial-gradient(circle at center,
      rgba(11, 96, 194, 0.25),
      rgba(0, 0, 0, 0.95) 70%);
  z-index: -1;
} */

@keyframes breathe {
  0% { box-shadow: 0 0 25px rgba(0,120,255,0.3); }
  50% { box-shadow: 0 0 45px rgba(254, 225, 3, 0.967); }
  100% { box-shadow: 0 0 25px rgba(0,120,255,0.3); }
}

#lightbox-img {
  animation: breathe 5s ease-in-out infinite;
}





  </style>
</head>

<body>

<h2>Exposure Therapy</h2>
<div id="exposure-therapy"></div>

<div id="lightbox">
  <span class="close">√ó</span>
  <span class="nav prev">‚ùÆ</span>
  <img id="lightbox-img">
  <span class="nav next">‚ùØ</span>
</div>

<script>
  const storageAccount = "iacterraformst";
  const containerName = "photogallery";
  const baseUrl = `https://${storageAccount}.blob.core.windows.net/${containerName}`;

  let i = 1;
  const maxImages = 1000;
  const images = [];
  let currentIndex = 0;

function loadNext() {
  if (i > maxImages) return;

  const img = document.createElement("img");
  const imgIndex = i - 1;   // üî• correct index

  img.src = `${baseUrl}/${i}.jpeg`;

  img.onload = () => {
    images.push(img.src);

    img.onclick = () => openLightbox(imgIndex); // üî• FIX
    document.getElementById("exposure-therapy").appendChild(img);

    i++;
    loadNext();
  };

  img.onerror = () => {
    i++;
    loadNext();
  };
}


  function openLightbox(index) {
    currentIndex = index;
    document.getElementById("lightbox-img").src = images[currentIndex];
    document.getElementById("lightbox").style.display = "flex";
    document.body.classList.add("lightbox-open");
  }

  function closeLightbox() {
    document.getElementById("lightbox").style.display = "none";
    document.body.classList.remove("lightbox-open");
  }

  function nextImg() {
    currentIndex = (currentIndex + 1) % images.length;
    openLightbox(currentIndex);
  }

  function prevImg() {
    currentIndex = (currentIndex - 1 + images.length) % images.length;
    openLightbox(currentIndex);
  }

  document.querySelector(".close").onclick = closeLightbox;
  document.querySelector(".next").onclick = nextImg;
  document.querySelector(".prev").onclick = prevImg;

  document.addEventListener("keydown", e => {
    if (e.key === "Escape") closeLightbox();
    if (e.key === "ArrowRight") nextImg();
    if (e.key === "ArrowLeft") prevImg();
  });

  loadNext();
</script>



</body>
</html>
